{
  "name": "ttc-service-map",
  "version": "2026.1.13.1",
  "description": "A network status map for the Toronto Transit Commission.",
  "author": "Andrew F. Ilersich <andrew.ilersich@mail.utoronto.ca> (https://www.ilersich.com/)",
  "contributors": [
    "Kevin Xu <wenkai.xu@mail.utoronto.ca> (https://github.com/KevinUTAT)",
    "Anthony Ilersich <antonio.ilersich@gmail.com>"
  ],
  "license": "GPL-3.0-only",
  "type": "module",
  "main": "api/index.js",
  "dependencies": {
    "@prisma/adapter-d1": "^7.2.0",
    "@prisma/client": "^7.2.0",
    "csv-parse": "^6.1.0",
    "dotenv": "^17.2.3",
    "prisma": "^7.2.0",
    "stream-transform": "^3.4.0",
    "unzipper": "^0.12.3"
  },
  "scripts": {
    "start": "npm run dev",
    "dev": "cd build && npx wrangler pages dev ./public",
    "dev:debug": "npm run dev -- --log-level=debug",
    "postinstall": "node scripts/postInstall.js",
    "prebuild": "npm run db:genTypes && npm run pb:generate",
    "build": "tsc -b",
    "postbuild": "node scripts/postBuild.js",
    "build:remote": "npm run db:migrate:remote && npm run build",
    "build:watch": "tsc -b -w",
    "rebuild": "npm ci && npm run build",
    "db:diff": "npx prisma migrate diff --from-config-datasource --to-schema ./prisma/schema.prisma",
    "db:genSyncScript": "prisma migrate diff --from-config-datasource --to-schema ./prisma/schema.prisma --script > ./migrations/$(date -u +%s).sql",
    "db:migrate": "npx wrangler d1 migrations apply ttcmapdb",
    "db:migrate:remote": "px wrangler d1 migrations apply ttcmapdb --remote",
    "db:drop": "rm -rf .wrangler/state/v3/d1/*",
    "db:genTypes": "npx prisma generate",
    "pb:download": "curl -# -O https://raw.githubusercontent.com/google/transit/e62ea02efd8987cd6a5eaf8438de7feef9303857/gtfs-realtime/proto/gtfs-realtime.proto",
    "pb:generate": "npx pbjs --keep-case -t static-module -w es6 -o generated/gtfs-realtime.js gtfs-realtime.proto && npx pbts -o generated/gtfs-realtime.d.ts generated/gtfs-realtime.js"
  },
  "devDependencies": {
    "@cloudflare/workers-types": "^4.20260114.0",
    "@types/better-sqlite3": "^7.6.13",
    "@types/node": "^25.0.3",
    "@types/unzipper": "^0.10.11",
    "protobufjs-cli": "^2.0.0",
    "replace-in-file": "^8.4.0",
    "typescript": "^5.9.3",
    "wrangler": "^4.59.1"
  }
}
